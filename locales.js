// Локализация для калькулятора проявки плёнки
// Версия: 1.0.0

export const LOCALES = {
    'en': {
        // Основные элементы
        'title': 'Film develop calculator',
        'calculate': 'Calculate',
        'back': '← Back',
        'start': 'Start',
        'pause': 'Pause',
        'reset': 'Reset',
        'time': 'Time',
        'timer': 'Timer',
        'done': 'Done!',
        
        // Поля формы
        'film': 'Film:',
        'developer': 'Developer:',
        'dilution': 'Dilution:',
        'iso': 'ISO/EI:',
        'temperature': 'Temperature (°C):',
        'customTime': 'Custom time:',
        'baseTime': 'Base time:',
        'manualInput': 'Manual input',
        'fromDatabase': 'From database:',
        'defaultTime': 'Default time (no data available)',
        'ratio': 'Ratio:',
        'process': 'Process:',
        'push': 'Push',
        'pull': 'Pull',
        'steps': 'Steps:',
        'min': 'min.',
        'sec': 'sec.',
        
        // Информационная панель
        'current': 'Current:',
        'process': 'Process:',
        'basicTime': 'Basic time:',
        'data': 'Data:',
        'available': '✓ Available',
        'noData': '✗ No data',
        
        // Температуры
        'temp14': '14°C (+80%)',
        'temp15': '15°C (+60%)',
        'temp16': '16°C (+40%)',
        'temp17': '17°C (+25%)',
        'temp18': '18°C (+10%)',
        'temp19': '19°C (+5%)',
        'temp20': '20°C (Standard)',
        'temp21': '21°C (-5%)',
        'temp22': '22°C (-15%)',
        'temp23': '23°C (-25%)',
        'temp24': '24°C (-35%)',
        'temp25': '25°C (-45%)',
        
        // Разведения
        'stock': 'Stock',
        'dilution1+1': '1+1',
        'dilution1+2': '1+2',
        'dilution1+3': '1+3',
        'dilution1+4': '1+4',
        'dilution1+9': '1+9',
        'dilution1+14': '1+14',
        'dilution1+15': '1+15',
        'dilution1+19': '1+19',
        'dilution1+25': '1+25',
        'dilution1+29': '1+29',
        'dilution1+31': '1+31',
        'dilution1+47': '1+47',
        'dilution1+50': '1+50',
        'dilution1+100': '1+100',
        'hc110A': 'A 1+15 (HC-110)',
        'hc110B': 'B 1+31 (HC-110)',
        'hc110E': 'E 1+47 (HC-110)',
        
        // Группы плёнок
        'groupIlford': 'Ilford',
        'groupKodak': 'Kodak',
        'groupFoma': 'Foma',
        'groupKentmere': 'Kentmere',
        'groupOther': 'Other',
        'groupCustom': 'Custom',
        
        // Группы проявителей
        'groupDevelopersIlford': 'Ilford',
        'groupDevelopersKodak': 'Kodak',
        'groupDevelopersOther': 'Other',
        'groupDevelopersCustom': 'Custom',
        
        // Пользовательские настройки
        'manualInput': 'Manual input',
        'custom': 'Custom',
        
        // Результаты
        'basicTimeLabel': 'Basic time',
        'step1': '+1 step',
        'step2': '+2 steps',
        'step3': '+3 steps',
        'step4': '+4 steps',
        'step5': '+5 steps',
        'pullStep1': '-1 step',
        'pullStep2': '-2 steps',
        'pullStep3': '-3 steps',
        'pullStep4': '-4 steps',
        'pullStep5': '-5 steps',
        
        // Уведомления
        'developmentComplete': 'Development complete!',
        
        // Управление пресетами
        'presetsManagement': 'Presets Management',
        'films': 'Films',
        'developers': 'Developers',
        'developmentTimes': 'Development Times',
        'addFilm': 'Add Film',
        'addDeveloper': 'Add Developer',
        'addTime': 'Add Time',
        'edit': 'Edit',
        'delete': 'Delete',
        'save': 'Save',
        'cancel': 'Cancel',
        'filmPresets': 'Film Presets',
        'developerPresets': 'Developer Presets',
        'timePresets': 'Development Time Presets',
        
        // ISO значения
        'iso25': '25',
        'iso50': '50',
        'iso80': '80',
        'iso100': '100',
        'iso125': '125',
        'iso200': '200',
        'iso250': '250',
        'iso320': '320',
        'iso400': '400',
        'iso500': '500',
        'iso800': '800',
        'iso1600': '1600',
        'iso3200': '3200',
        'iso6400': '6400',
        'iso12500': '12500'
    },
    
    'ru': {
        // Основные элементы
        'title': 'Калькулятор проявки плёнки',
        'calculate': 'Рассчитать',
        'back': '← Назад',
        'start': 'Старт',
        'pause': 'Пауза',
        'reset': 'Сброс',
        'time': 'Время',
        'timer': 'Таймер',
        'done': 'Готово!',
        
        // Поля формы
        'film': 'Плёнка:',
        'developer': 'Проявитель:',
        'dilution': 'Разведение:',
        'iso': 'ISO/EI:',
        'temperature': 'Температура (°C):',
        'customTime': 'Пользовательское время:',
        'baseTime': 'Базовое время:',
        'manualInput': 'Ручной ввод',
        'fromDatabase': 'Из базы данных:',
        'defaultTime': 'Время по умолчанию (нет данных)',
        'ratio': 'Коэффициент:',
        'process': 'Процесс проявки:',
        'push': 'Push',
        'pull': 'Pull',
        'steps': 'Количество ступеней:',
        'min': 'мин',
        'sec': 'сек',
        
        // Информационная панель
        'current': 'Текущие настройки:',
        'process': 'Процесс:',
        'basicTime': 'Базовое время:',
        'data': 'Данные:',
        'available': '✓ Доступны',
        'noData': '✗ Нет данных',
        
        // Температуры
        'temp14': '14°C (+80% времени)',
        'temp15': '15°C (+60% времени)',
        'temp16': '16°C (+40% времени)',
        'temp17': '17°C (+25% времени)',
        'temp18': '18°C (+10% времени)',
        'temp19': '19°C (+5% времени)',
        'temp20': '20°C (стандартная температура)',
        'temp21': '21°C (-5% времени)',
        'temp22': '22°C (-15% времени)',
        'temp23': '23°C (-25% времени)',
        'temp24': '24°C (-35% времени)',
        'temp25': '25°C (-45% времени)',
        
        // Разведения
        'stock': 'Stock',
        'dilution1+1': '1+1',
        'dilution1+2': '1+2',
        'dilution1+3': '1+3',
        'dilution1+4': '1+4',
        'dilution1+50': '1+50',
        'dilution1+100': '1+100',
        'hc110A': 'A 1+15 (HC-110)',
        'hc110B': 'B 1+31 (HC-110)',
        'hc110E': 'E 1+47 (HC-110)',
        
        // Группы плёнок
        'groupIlford': 'Ilford',
        'groupKodak': 'Kodak',
        'groupFoma': 'Foma',
        'groupKentmere': 'Kentmere',
        'groupOther': 'Другие',
        'groupCustom': 'Пользовательские',
        
        // Группы проявителей
        'groupDevelopersIlford': 'Ilford',
        'groupDevelopersKodak': 'Kodak',
        'groupDevelopersOther': 'Другие',
        'groupDevelopersCustom': 'Пользовательские',
        
        // Пользовательские настройки
        'manualInput': 'Ручной ввод',
        'custom': 'Пользовательский',
        
        // Результаты
        'basicTimeLabel': 'Базовое время',
        'step1': '+1 ступень',
        'step2': '+2 ступени',
        'step3': '+3 ступени',
        'step4': '+4 ступени',
        'step5': '+5 ступеней',
        'pullStep1': '-1 ступень',
        'pullStep2': '-2 ступени',
        'pullStep3': '-3 ступени',
        'pullStep4': '-4 ступени',
        'pullStep5': '-5 ступеней',
        
        // Уведомления
        'developmentComplete': 'Проявка завершена!',
        
        // Управление пресетами
        'presetsManagement': 'Управление пресетами',
        'films': 'Плёнки',
        'developers': 'Проявители',
        'developmentTimes': 'Времена проявки',
        'addFilm': 'Добавить плёнку',
        'addDeveloper': 'Добавить проявитель',
        'addTime': 'Добавить время',
        'edit': 'Изменить',
        'delete': 'Удалить',
        'save': 'Сохранить',
        'cancel': 'Отмена',
        'filmPresets': 'Пресеты плёнок',
        'developerPresets': 'Пресеты проявителей',
        'timePresets': 'Пресеты времён проявки',
        
        // ISO значения
        'iso25': '25',
        'iso50': '50',
        'iso80': '80',
        'iso100': '100',
        'iso125': '125',
        'iso200': '200',
        'iso250': '250',
        'iso320': '320',
        'iso400': '400',
        'iso500': '500',
        'iso800': '800',
        'iso1600': '1600',
        'iso3200': '3200',
        'iso6400': '6400',
        'iso12500': '12500'
    }
};

// Класс для управления локализацией
export class LocalizationManager {
    constructor() {
        this.currentLocale = this.detectLanguage();
        this.translations = LOCALES[this.currentLocale] || LOCALES['en'];
    }
    
    // Автоматическое определение языка
    detectLanguage() {
        const browserLang = navigator.language || navigator.userLanguage;
        const langCode = browserLang.split('-')[0].toLowerCase();
        
        // Если браузер на русском - используем русский
        if (langCode === 'ru') {
            return 'ru';
        }
        
        // По умолчанию английский
        return 'en';
    }
    
    // Получить перевод по ключу
    t(key) {
        return this.translations[key] || key;
    }
    
    // Установить язык
    setLanguage(locale) {
        this.currentLocale = locale;
        this.translations = LOCALES[locale] || LOCALES['en'];
        this.updateUI();
    }
    
    // Получить текущий язык
    getCurrentLanguage() {
        return this.currentLocale;
    }
    
    // Обновить интерфейс
    updateUI() {
        // Обновляем заголовок
        document.title = this.t('title');
        this.updateElement('appTitle', this.t('title'));
        
        // Обновляем основные элементы
        this.updateElement('calculateBtn', this.t('calculate'));
        this.updateElement('backButton', this.t('back'));
        this.updateElement('startPauseButton', this.t('start'));
        this.updateElement('resetButton', this.t('reset'));
        this.updateElement('timerLabel', this.t('time'));
        this.updateElement('timerTitle', this.t('timer'));
        
        // Обновляем лейблы полей
        this.updateLabel('filmSelect', this.t('film'));
        this.updateLabel('developerSelect', this.t('developer'));
        this.updateLabel('dilutionSelect', this.t('dilution'));
        this.updateLabel('isoSelect', this.t('iso'));
        this.updateLabel('temperatureSelect', this.t('temperature'));
        this.updateLabel('coefficient', this.t('ratio'));
        this.updateLabel('process', this.t('process'));
        this.updateLabel('steps', this.t('steps'));
        
        // Обновляем кнопки процесса
        this.updateProcessButtons();
        
        // Обновляем лейбл базового времени
        const customTimeLabel = document.querySelector('#customTimeSection label');
        if (customTimeLabel) {
            customTimeLabel.textContent = this.t('baseTime');
        }
        
        // Обновляем единицы измерения времени
        const timeLabels = document.querySelectorAll('#customTimeSection .text-gray-400');
        timeLabels.forEach(label => {
            if (label.textContent.includes('min.')) {
                label.textContent = this.t('min');
            } else if (label.textContent.includes('sec.')) {
                label.textContent = this.t('sec');
            }
        });
        
        // Обновляем информационную панель
        this.updateInfoPanel();
        
        // Обновляем опции разведений
        this.updateDilutionOptions();
        
        // Обновляем опции ISO
        this.updateISOOptions();
        
        // Обновляем опции температур
        this.updateTemperatureOptions();
        
        // Обновляем интерфейс управления пресетами
        this.updatePresetsInterface();
    }
    
    // Обновить элемент
    updateElement(id, text) {
        const element = document.getElementById(id);
        if (element) {
            element.textContent = text;
        }
    }
    
    // Обновить лейбл
    updateLabel(inputId, text) {
        const input = document.getElementById(inputId);
        if (input) {
            // Ищем лейбл перед элементом
            let label = input.previousElementSibling;
            if (label && label.tagName === 'LABEL') {
                label.textContent = text;
            } else {
                // Ищем лейбл по for атрибуту
                const labelFor = document.querySelector(`label[for="${inputId}"]`);
                if (labelFor) {
                    labelFor.textContent = text;
                }
            }
        }
    }
    
    // Обновить информационную панель
    updateInfoPanel() {
        const infoPanel = document.getElementById('infoPanel');
        if (infoPanel) {
            const title = infoPanel.querySelector('.text-sm.text-gray-400');
            if (title) {
                title.textContent = this.t('current') + ':';
            }
            
            // Обновляем лейблы в панели
            const labels = infoPanel.querySelectorAll('.text-gray-300');
            labels.forEach(label => {
                const text = label.textContent;
                if (text.includes('Film:')) label.textContent = this.t('film');
                else if (text.includes('Developer:')) label.textContent = this.t('developer');
                else if (text.includes('Dilution:')) label.textContent = this.t('dilution');
                else if (text.includes('ISO/EI:')) label.textContent = this.t('iso');
                else if (text.includes('Temperature:')) label.textContent = this.t('temperature');
                else if (text.includes('Process:')) label.textContent = this.t('process');
                else if (text.includes('Basic time:')) label.textContent = this.t('basicTime');
                else if (text.includes('Data:')) label.textContent = this.t('data');
            });
        }
    }
    
    // Обновить опции разведений
    updateDilutionOptions() {
        const dilutionSelect = document.getElementById('dilutionSelect');
        if (dilutionSelect) {
            const options = dilutionSelect.querySelectorAll('option');
            options.forEach(option => {
                const value = option.value;
                if (value === 'stock') option.textContent = this.t('stock');
                else if (value === '1+1') option.textContent = this.t('dilution1+1');
                else if (value === '1+2') option.textContent = this.t('dilution1+2');
                else if (value === '1+3') option.textContent = this.t('dilution1+3');
                else if (value === '1+4') option.textContent = this.t('dilution1+4');
                else if (value === '1+50') option.textContent = this.t('dilution1+50');
                else if (value === '1+100') option.textContent = this.t('dilution1+100');
                else if (value === 'A 1+15') option.textContent = this.t('hc110A');
                else if (value === 'B 1+31') option.textContent = this.t('hc110B');
                else if (value === 'E 1+47') option.textContent = this.t('hc110E');
            });
        }
    }
    
    // Обновить опции ISO
    updateISOOptions() {
        const isoSelect = document.getElementById('isoSelect');
        if (isoSelect) {
            const options = isoSelect.querySelectorAll('option');
            options.forEach(option => {
                const value = option.value;
                option.textContent = this.t('iso' + value);
            });
        }
    }
    
    // Обновить опции температур
    updateTemperatureOptions() {
        const tempSelect = document.getElementById('temperatureSelect');
        if (tempSelect) {
            const options = tempSelect.querySelectorAll('option');
            options.forEach(option => {
                const value = option.value;
                option.textContent = this.t('temp' + value);
            });
        }
    }
    
    // Получить перевод для статуса данных
    getDataStatusText(hasData) {
        return hasData ? this.t('available') : this.t('noData');
    }
    
    // Получить перевод для времени завершения
    getDoneText() {
        return this.t('done');
    }
    
    // Получить перевод для уведомления
    getNotificationText() {
        return this.t('developmentComplete');
    }
    
    // Получить перевод для ступеней
    getStepText(step, process = 'push') {
        if (process === 'pull') {
            if (step === 1) return this.t('pullStep1');
            if (step === 2) return this.t('pullStep2');
            if (step === 3) return this.t('pullStep3');
            if (step === 4) return this.t('pullStep4');
            if (step === 5) return this.t('pullStep5');
            return `-${step} steps`;
        } else {
            if (step === 1) return this.t('step1');
            if (step === 2) return this.t('step2');
            if (step === 3) return this.t('step3');
            if (step === 4) return this.t('step4');
            if (step === 5) return this.t('step5');
            return `+${step} steps`;
        }
    }
    
    // Получить перевод для базового времени
    getBasicTimeText() {
        return this.t('basicTimeLabel');
    }
    
    // Обновить кнопки процесса
    updateProcessButtons() {
        const pushBtn = document.getElementById('pushProcess');
        const pullBtn = document.getElementById('pullProcess');
        
        if (pushBtn) pushBtn.textContent = this.t('push');
        if (pullBtn) pullBtn.textContent = this.t('pull');
    }
    
    // Обновить интерфейс управления пресетами
    updatePresetsInterface() {
        // Заголовок модального окна
        this.updateElement('presetsModalTitle', this.t('presetsManagement'));
        
        // Вкладки
        const tabs = document.querySelectorAll('.preset-tab');
        tabs.forEach(tab => {
            const tabName = tab.dataset.tab;
            if (tabName === 'films') tab.textContent = this.t('films');
            else if (tabName === 'developers') tab.textContent = this.t('developers');
            else if (tabName === 'times') tab.textContent = this.t('developmentTimes');
        });
        
        // Заголовки вкладок
        this.updateElement('filmsTab', this.t('filmPresets'));
        this.updateElement('developersTab', this.t('developerPresets'));
        this.updateElement('timesTab', this.t('timePresets'));
        
        // Кнопки добавления
        this.updateElement('addFilmBtn', this.t('addFilm'));
        this.updateElement('addDeveloperBtn', this.t('addDeveloper'));
        this.updateElement('addTimeBtn', this.t('addTime'));
        
        // Кнопки в списках
        const editButtons = document.querySelectorAll('.bg-blue-600');
        editButtons.forEach(btn => {
            if (btn.textContent === 'Edit') btn.textContent = this.t('edit');
        });
        
        const deleteButtons = document.querySelectorAll('.bg-red-600');
        deleteButtons.forEach(btn => {
            if (btn.textContent === 'Delete') btn.textContent = this.t('delete');
        });
        
        // Кнопки в форме
        this.updateElement('saveBtn', this.t('save'));
        this.updateElement('deleteBtn', this.t('delete'));
    }
} 